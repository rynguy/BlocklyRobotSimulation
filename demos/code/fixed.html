<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google" value="notranslate">
  <title>Blockly Demo:</title>
  <link rel="stylesheet" href="style.css">
  <script src="/storage.js"></script>
  <script src="../../blockly_compressed.js"></script>
  <script src="../../blocks_compressed.js"></script>
  <script src="../../ch_compressed.js"></script>
  <script src="../../cpp_compressed.js"></script>
  <script src="../../core/workspace.js"></script>
  <script src="../../generators/ch/linkbot.js"></script>
  <script src="../../generators/cpp/linkbot.js"></script>
  <script src="code.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  
  <nav class="navbar navbar-default">
  <div style="background-color:#00ADBC; color:#FFF;" class="container-fluid">
    <div style="background-color:#00ADBC; color:#FFF;" class="navbar-header">
      <a style="background-color:#00ADBC; color:#FFF;" class="navbar-brand" href="#">
        <span class="glyphicon glyphicon-bed" aria-hidden="true"></span>
        Robot Coding Lessons
      </a>
    </div>
  </div>
</nav>
<style>
  #horizTranslate {
  }
</style>
</head>
<body>
  <h1 style="visibility:hidden;"><a href="https://developers.google.com/blockly/">Blockly</a> &gt;
    <a href="../index.html">Demos</a> &gt; Fixed Blockly</h1>

  <div class="row">

    <div style="margin-left:10px;" class="col-md-5">
    <div style="position:absolute; z-index:1; " class='box'><img src="./img/minds_Transparent.png"></div> 

      <div id= "grid" style="width:100%; height:480px; float:left; background-color:#00FFFF">
       <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
         <defs>
           <pattern id="smallGrid" width="16" height="16" patternUnits="userSpaceOnUse">
             <path d="M 16 0 L 0 0 0 16" fill="none" stroke="gray" stroke-width=".5"/>
           </pattern>
           <pattern id="grid" width="160" height="160" patternUnits="userSpaceOnUse">
             <rect width="160" height="160" fill="url(#smallGrid)"/>
             <path d="M 160 0 L 0 0 0 160" fill="none" stroke="gray" stroke-width="1"/>
           </pattern>
         </defs>

         <rect width="100%" height="100%" fill="url(#grid)" />
       </svg>
      </div>
    </div>
    <div class="col-md-6">
    <table width="100%" height="100%">
    
    <tr>
      <td colspan=2>
        <table width="100%">
          <tr style="background-color:#7665A0;" id="tabRow" height="1em">
            <td style="background-color:#7665A0;" id="tab_blocks" class="tabon">Blocks</td>
            <td style="background-color:#FFF;" class="tabmin">&nbsp;</td>
            <td style="background-color:#7665A0;" id="tab_ch" class="taboff">ch</td>
            <td style="background-color:#FFF;" class="tabmin">&nbsp;</td>
            <td style="background-color:#7665A0;" id="tab_cpp" class="taboff">cpp</td>
            <td style="background-color:#FFF;" class="tabmin">&nbsp;</td>
            <td class="tabmax">
              <button style="margin-top:5px;" id="trashButton"  title="...">
                <img src='../../media/1x1.gif' class="trash icon21">
              </button>
              <button id="linkButton" class="notext" title="...">
                <img src='../../media/1x1.gif' class="link icon21">
              </button>
              
              <button style="margin-bottom:5px; width:35spx; height:27px;" class='toggleButton' value='play'><img src='../../media/1x1.gif' class="run icon21">
              </button>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td height="99%" colspan=2 id="content_area">
      </td>
    </tr>
  </table>
  <div id="content_blocks" class="content"></div>
  <pre id="content_ch" class="content"></pre>
  <pre id="content_cpp" class="content"></pre>
  <textarea id="content_xml" class="content" wrap="off"></textarea>
      <div id="blocklyDiv" style="height: 449px; width: 100%;"></div>
    </div>
  </div>
  <xml id="toolbox" style="display: none">
    <block type="controls_if"></block>
    <block type="logic_compare"></block>
    <block type="controls_repeat_ext"></block>
    <block type="math_number"></block>
    <block type="math_arithmetic"></block>
    <block type="text"></block>
    <block type="text_print"></block>
    <block type="linkbot_drive_distance"></block>
  </xml>

  <script>
    Blockly.inject(document.getElementById('blocklyDiv'),
        {toolbox: document.getElementById('toolbox')});
  </script>





<script type="text/javascript">
  var $robotime;
  var round = Math.round;
      var boxOne = document.getElementsByClassName('box')[0],
    $boxTwo = $('.box:eq(1)');

document.getElementsByClassName('toggleButton')[0].onclick = function() {
  
    var rootBlock = null;
    var secBlock = null;

    var blocks = Blockly.mainWorkspace.getTopBlocks(false);
    for (var i = 0, block; i < blocks.length; i++) {
      block = blocks[i];
      console.log(blocks.length + "dicks");
      if (block.type == 'linkbot_drive_distance') {
        rootBlock = block;
      }
      //if (block.type == 'linkbot_turn') {
        //secBlock = block;
      //}
    }
    for (var i = 0, block; block = blocks[i]; i++) {
      if (block.type == 'linkbot_drive') {
        rootBlock = block;
        break;
      }
      //if (block.type == 'linkbot_turn') {
        //secBlock = block;
      //}
    }
    //dis is the input from the puzzle
    var $dis2 = (round(rootBlock.getFieldValue('distance'))*25)  + round(60);
    var $dis = (round(rootBlock.getFieldValue('distance'))*25)+ round(30);
    $robotime = (round(rootBlock.getFieldValue('distance'))*25)/500;
    boxOne.id = 'horizTranslate';
    $('#horizTranslate').css({'-webkit-transition': $robotime+'s linear'});
    $('#horizTranslate').css({'-moz-transition': $robotime+'s linear'});
    $('#horizTranslate').css({'-ms-transition': $robotime+'s linear'});
    $('#horizTranslate').css({'-o-transition': $robotime+'s linear'});
    $('#horizTranslate').css({'transition': $robotime+'s linear'});
    $('#horizTranslate').css({'margin-left': $dis + "px"});
    elem = sv.getElementById("tits");
    elem.setAttribute("d", "M 113 113 L"+ $dis2 + " 113");
 
  //console.log("capacity: " + Blockly.Workspace.prototype.remainingCapacity())
    //var block = Blockly.Workspace.prototype.getBlockById('linkbot_drive');
    console.log("block id: " + rootBlock);
    console.log("distance in the block: " + $dis);
    updateStyleSheet('line');
    //this.innerHTML = 'Pause';
    boxOne.classList.add('horizTranslate');
    $("#success").css({'visibility':'visible'});
   
}

$('.toggleButton:eq(1)').on('click', function() { 
  if($(this).html() === 'Play') 
  {
    $(this).html('Pause');
    $boxTwo.addClass('horizTranslate');
  } else {
    $(this).html('Play');
    var computedStyle = $boxTwo.css('margin-left');
    $boxTwo.removeClass('horizTranslate');
    $boxTwo.css('margin-left', computedStyle);
  }  
});
  </script>

  <script type="text/javascript">
  document.getElementsByClassName('resetButton')[0].onclick = function(){
    updateStyleSheet('nothing');
    elem = sv.getElementById("tits");
    $("#success").css({'visibility':'hidden'});
    $('#horizTranslate').css({'margin-left': 0 + "px"});
  }
  </script>

  <script>
  //function to change style sheet
    function updateStyleSheet(filename) {
 
    // Create the CSS file name:
 
    newstylesheet = "style_" + filename + ".css";
 
    // Does the <link> tag (with id:dynamic_css) exist?
    // If not, we need to create it.
 
    if ($("#dynamic_css").length == 0) {
 
        // The next line will add the
        // <link> tag between the
        // <head> tags.
 
        $("head").append("<link>")
 
        // The next line will select the
        // <link> element you just added.
 
        css = $("head").children(":last");
 
        // The next line will set the
        // attributes of the elements
        // to make it load the CSS file.
 
        css.attr({
          id: "dynamic_css",
          rel:  "stylesheet",
          type: "text/css",
          href: newstylesheet
        });

        //$("#tits").css({'visibility':'visible'});
 
    // If the <link> element already exists, we
    // simply need to change the value of "href". 
 
    } else {
        $("#dynamic_css").attr("href",newstylesheet);
    }
 
}
  </script>




  <script>
  var elem;
  var sv = document.getElementById("mysvg");
  console.log("ass");
  console.log(sv);
  console.log("balls")
  //var sdoc = sv.getSVGDocument();
  console.log(sv);
  </script>
  <div id="horizTranslate" style="visibility:hidden"></div>


</body>
</html>
